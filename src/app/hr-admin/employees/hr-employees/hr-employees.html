<div class="employee-management-container bg-gray-50 min-h-screen p-4">

    <!-- PAGE HEADER -->
    <div class="page-header-section flex flex-col gap-4 mb-4">
        <p-breadcrumb [model]="breadcrumbItems()"></p-breadcrumb>

        <div class="flex justify-end">
            <p-button label="Add Employee" icon="pi pi-plus" (click)="showDialog()" [raised]="true"
                styleClass="bg-blue-600 hover:bg-blue-700 border-blue-600 text-white px-4 py-2 rounded-lg shadow">
            </p-button>
        </div>
    </div>

    <!-- VIEW EMPLOYEE DRAWER -->
    <p-drawer [(visible)]="viewDialogVisible" position="right" [modal]="true" [dismissible]="false"
        [style]="{ width: '820px', maxWidth: '100vw' }">

        <ng-template pTemplate="header">
            <div class="flex items-center justify-between px-4 py-3 border-b bg-gray-100">
                <div class="flex items-center gap-2">
                    <i class="pi pi-eye text-blue-600"></i>
                    <span class="text-lg font-semibold">View Employee Details</span>
                </div>
                <p-button icon="pi pi-times" [text]="true" [rounded]="true" (click)="viewDialogVisible.set(false)">
                </p-button>
            </div>
        </ng-template>

        <div *ngIf="selectedEmployee()" class="flex flex-col gap-6 p-4">

            <p-panel header="Employee Identity" [toggleable]="true">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="font-semibold">Employee Code</label>
                        <p>{{ selectedEmployee()?.employeeCode }}</p>
                    </div>
                    <div>
                        <label class="font-semibold">Status</label>
                        <span class="px-2 py-1 rounded-full text-xs font-semibold" [ngClass]="{
                              'bg-green-100 text-green-700': selectedEmployee()?.status === 'ACTIVE',
                              'bg-red-100 text-red-700': selectedEmployee()?.status !== 'ACTIVE'
                            }">
                            {{ selectedEmployee()?.status }}
                        </span>
                    </div>
                </div>
            </p-panel>

            <p-panel header="Personal Details" [toggleable]="true">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><label class="font-semibold">First Name</label>
                        <p>{{ selectedEmployee()?.firstName }}</p>
                    </div>
                    <div><label class="font-semibold">Last Name</label>
                        <p>{{ selectedEmployee()?.lastName }}</p>
                    </div>
                    <div><label class="font-semibold">Gender</label>
                        <p>{{ selectedEmployee()?.gender }}</p>
                    </div>
                    <div><label class="font-semibold">DOB</label>
                        <p>{{ formatDate(selectedEmployee()?.dateOfBirth) }}</p>
                    </div>
                </div>
            </p-panel>

            <p-panel header="Contact Details" [toggleable]="true">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><label class="font-semibold">Email</label>
                        <p>{{ selectedEmployee()?.email }}</p>
                    </div>
                    <div><label class="font-semibold">Mobile</label>
                        <p>{{ selectedEmployee()?.mobileNumber }}</p>
                    </div>
                </div>
            </p-panel>

        </div>

        <ng-template pTemplate="footer">
            <div class="flex justify-end p-4 border-t">
                <p-button label="Close" (click)="viewDialogVisible.set(false)"
                    styleClass="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded">
                </p-button>
            </div>
        </ng-template>
    </p-drawer>

    <!-- TABLE -->
    <div class="table-container bg-white rounded-xl shadow p-3">
        <p-table [value]="employees()" [loading]="loading()" [paginator]="true" [rows]="10" responsiveLayout="scroll">

            <ng-template pTemplate="header">
                <tr class="bg-gray-100">
                    <th class="text-center">Actions</th>
                    <th>Employee Code</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Mobile</th>
                    <th>Department</th>
                    <th>Designation</th>
                    <th>Type</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Joining</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-employee>
                <tr class="hover:bg-gray-50">
                    <td class="text-center">
                        <p-button icon="pi pi-ellipsis-v" [text]="true" [rounded]="true"
                            (click)="actionMenu.toggle($event)">
                        </p-button>
                        <p-menu #actionMenu [model]="getActionMenuItems(employee)" [popup]="true"></p-menu>
                    </td>

                    <td>{{ employee.employeeCode }}</td>
                    <td>{{ employee.firstName }} {{ employee.lastName }}</td>
                    <td>{{ employee.email }}</td>
                    <td>{{ employee.mobileNumber }}</td>
                    <td>{{ employee.department }}</td>
                    <td>{{ employee.designation }}</td>
                    <td>{{ employee.employmentType }}</td>
                    <td>{{ employee.role }}</td>

                    <td>
                        <span class="px-2 py-1 rounded-full text-xs font-semibold" [ngClass]="{
                              'bg-green-100 text-green-700': employee.status === 'ACTIVE',
                              'bg-red-100 text-red-700': employee.status !== 'ACTIVE'
                            }">
                            {{ employee.status }}
                        </span>
                    </td>

                    <td>{{ formatDate(employee.joiningDate) }}</td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="11" class="text-center py-6 text-gray-500">
                        No employees found
                    </td>
                </tr>
            </ng-template>

        </p-table>
    </div>

</div>